<div class="tab__form-wrapper">
  <form nz-form [formGroup]="baseForm" [nzLayout]="'vertical'">
    <nz-button-group class="tab__actions">
      <button nz-button type="submit" [nzType]="'primary'" (click)="onSave()">
        {{ "BUTTON.SAVE" | translate }}
      </button>
    </nz-button-group>
    <div class="tab__form-controls">
      <div class="tab__form-control">
        <cvgen-input
          [label]="'FIRST_NAME'"
          inputType="text"
          formControlName="firstName"
        ></cvgen-input>
      </div>
      <div class="tab__form-control">
        <cvgen-input
          [label]="'LAST_NAME'"
          inputType="text"
          formControlName="lastName"
        ></cvgen-input>
      </div>
      <div class="tab__form-control">
        <cvgen-input [label]="'EMAIL'" inputType="email" formControlName="email"></cvgen-input>
      </div>
      <!-- TODO do i need those here too? -->
      <div class="tab__form-control">
        <cvgen-select
          [label]="'SPECIALIZATION'"
          formControlName="specialization"
          [listOfOptions]="specializationData"
        ></cvgen-select>
      </div>
      <div class="tab__form-control">
        <cvgen-select
          [label]="'DEPARTMENT'"
          formControlName="department"
          [listOfOptions]="departmentData"
        ></cvgen-select>
      </div>
      <div class="tab__form-control">
        <cvgen-multiselect
          [label]="'SKILLS'"
          formControlName="skills"
          [listOfOptions]="skillData"
        ></cvgen-multiselect>
      </div>
      <div class="tab__form-array-wrapper">
        <button class="tab__list-add-btn" nz-button (click)="addLanguage()">
          <p>
            Add a Language
            <span nz-icon nzType="plus" nzTheme="outline"></span>
          </p>
        </button>

        <div class="tab__form-array" formArrayName="language">
          @for (lang of languages.controls; let index = $index; track index) {
            <div class="tab__from-group" [formGroupName]="index">
              <div class="tab__form-control">
                <cvgen-select
                  [label]="'LANGUAGES'"
                  formControlName="name"
                  [listOfOptions]="languagesData"
                ></cvgen-select>
              </div>
              <div class="tab__form-control">
                <cvgen-select
                  [label]="'LEVELS'"
                  formControlName="level"
                  [listOfOptions]="levelData"
                ></cvgen-select>
              </div>
              <span
                class="tab__menu-item--delete"
                nz-icon
                nzType="delete"
                (click)="deleteLanguage(index)"
              ></span>
            </div>
          }
        </div>
      </div>
    </div>
  </form>
</div>
<div class="tab__projects">
  <nz-button-group class="tab__projects-actions">
    <button class="tab__projects-add-btn" nz-button [nzType]="'primary'">
      {{ "BUTTON.ADD_PROJECT" | translate }}
    </button>
    <button nz-button nz-dropdown [nzDropdownMenu]="cvsProjects" nzPlacement="bottomRight">
      <span nz-icon nzType="ellipsis"></span>
    </button>
  </nz-button-group>
  <nz-dropdown-menu #cvsProjects="nzDropdownMenu">
    <ul nz-menu>
      @for (project of projectData; track project) {
        <li nz-menu-item (click)="addNewProject(project)">{{ project.projectName }}</li>
      }
    </ul>
  </nz-dropdown-menu>

  <nz-collapse class="tab__projects-collapse" nzAccordion>
    <nz-collapse-panel
      *ngFor="let project of projects.controls"
      [nzHeader]="project.value.projectName"
      [nzExtra]="extraRemove"
      (click)="selectProject(project.value.id)"
    >
      <cvgen-project-form
        [selectedProjectData]="modifiedProject"
        [skillList]="skillData"
        [responsibilityList]="responsibilityList"
        [teamRolesList]="teamRolesList"
      ></cvgen-project-form>
    </nz-collapse-panel>
  </nz-collapse>

  <ng-template #extraRemove>
    <span nz-icon nzType="delete"></span>
  </ng-template>
</div>
